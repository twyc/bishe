<!-- 
	注册页面 
-->
<!DOCTYPE html>
<html>
<head>
		<title>用户注册</title>
		<meta http-equiv="content-type" content="text/html;charset=utf-8">
		<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
		<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=dba359696d9128e480e86a54ca9944f1"></script> 
		<script type="text/javascript" src="host.js"></script>
		<link rel="stylesheet" href="https://unpkg.com/purecss@0.6.1/build/pure-min.css" integrity="sha384-CCTZv2q9I9m3UOxRLaJneXrrqKwUNOzZ6NGEUMwHtShDJ+nCoiXJCAgi05KfkLGY" crossorigin="anonymous">

		<style type="text/css">
			body,html{
				width: all;
				height: all;
			}
			#fform{
				width:600px; 
				height:400px;
				position:absolute; 
				left:50%; 
				top:50%; 
				margin-left: -300px; 
				margin-top: -200px;
			}
		</style>
</head>

<body>
	
	<div id="fform">
		<h1>基于游记文本的旅游景点推荐系统</h1>
		<form class="pure-form pure-form-aligned">
		    <fieldset>
		        <div class="pure-control-group">
		            <label for="name">用户名</label>
		            <input v-model="name" type="text" placeholder="用户名" required>
		        </div>

		        <div class="pure-control-group">
		            <label for="password">密码</label>
		            <input v-model="password" type="password" placeholder="密码" required>
		        </div>

		        <div class="pure-control-group">
		            <label for="age">年龄</label>
		            <input v-model="age" type="text" placeholder="年龄" required>
		        </div>

		        <div class="pure-control-group">
		            <label for="hobby">兴趣爱好</label>
		            <input v-model="hobby" type="text" placeholder="兴趣爱好" required>
		        </div>

		        <div class="pure-control-group">
		            <label for="education">教育背景</label>
			        <select id="education">
			            <option>初中及以下</option>
			            <option>高中</option>
			            <option>大学及以上</option>
			        </select>
		        </div>

		        <div class="pure-control-group">
		            <label>性别</label>
			        <input @click="reverse()" type="checkbox" value="男" v-model="male"> 男
		            <input @click="reverse()" type="checkbox" value="女" v-model="female"> 女
		        </div>

		        <div class="pure-controls">
		            <button @click="onSubmit()" type="button" class="pure-button pure-button-primary">注册</button>
		            <button @click="toLogin()" type="button" class="pure-button pure-button-primary">去登录</button>
		        </div>
		    </fieldset>
		</form>
	</div>


</body>


<script>
	var app = new Vue({
		el:"#fform",
		data:{
			name:"",
			password:"",
			male:true,
			age:null,
			hobby:null,
			education:null,
			female:false
		},
		methods:{
			reverse:function(){
				this.male=!this.male;
				this.female=!this.female;
			},
			onSubmit:function(){
				if (this.name==""||this.password=="") {
					alert("用户名或密码为空！");
					return;
				}
				if (!this.age||!this.hobby) {
					alert("请将表单填写完整！");
					return;
				}
				var url = "http://"+host+":"+port+"/user/register";
				var that=this;
				var ssex;
				if (this.male) {
					ssex=1;
				}else{
					ssex=2;
				}
				let param = new URLSearchParams();
				param.append('userName',this.name);
				param.append('password',this.password);
				param.append('gender',Number(ssex));
				console.log(Number(this.age));
				if (isNaN(Number(this.age))) {
					alert("请在年龄处填写数字");
					return;
				}
				param.append('age',this.age);
				var edu=0;
				if (this.education=="初中及以下") {
					edu=1;
				}else if (this.education=="高中") {
					edu=2;
				}else{
					edu=3;
				}
				param.append('education',edu);
				param.append('hobby',this.hobby);
				axios({
				    method: 'post',
				    url: url,
				    data: param
				}).then(function(response){
					console.log(response);
					if (response.data.status=="failed") {
						alert("用户名重复！注册失败！");
					}else{
						alert("注册成功！");
						window.location="login.html";
					}
				});
			},
			toLogin:function(){
				window.location="login.html";
			}
		}
	});
</script>




</html>